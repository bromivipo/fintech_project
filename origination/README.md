## Схема

1. Заявка попадает в PE, создаются соответствующие строки в бд или возвращается ошибка при неверных входных данных. Если все верно возвращается agreement_id на случай если клиент захочет отслеживать статус договора.
2. PE отсылает инфу о договоре и клиенте в Originstion
3. Origination сохраняет инфу в свою бд и хранит статус каждого договора. Происходит проверка существовал ли раньше договор.
4. Затем какие-то данные отправляются в скоринг, пока непонятно какие именно, потому что не ясно, что конкретно будет делать скоринг.
5. Обратно получаем статус (одобрен или не одобрен)
6. Дальше это перекидываем в Origination, а оттуда в payment gate и PE, если кредит одобрен.

## Ответы

1. База данных в Origination нужна, потому что scoring не будет происходить моментально и нужно будет иметь возможность хранить много заявок одновременно. Также все данные из одного сервиса в другой я планирую передавать батчами, и даже если приедт один батч, хранить его уже неудобно без бд.

2. На случай отказов PE будет пересылать все agreement со статусом new с каждым следующим батчем. Когда Origination получит agreement, который уже был обработан, он в ответ пошлет инфу о статусе этого agreement. Если упал origination, то один и тот же батч из PE будет перезасылаться, пока origination не встанет. Если упадет PE, то если это произошло до того, как обработался application из API, то это будет видно в API, так как ответа никакого на запрос нет. А если после того как запрос обработался, то Agreement будет в батче следующем. Если Agreement уже был обработан, но ответ от Origination не дошел, то просто, когда в следующем батче будет отправлен этот agreement, origination еще раз перешлет его статус.
